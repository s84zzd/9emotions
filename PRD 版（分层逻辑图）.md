🌈 **PRD 版（分层逻辑图）**
===================

这个版本适合写进产品文档、工程文档。
**Level 1：情绪 → 能量趋势推断（核心升级）**
-----------------------------

| 情绪       | 推断能量趋势        |
| -------- | ------------- |
| 烦躁、压力    | high（能量过高）    |
| 焦虑       | chaotic（能量混乱） |
| 无助、疲惫、忧郁 | low（能量过低）     |
| 平静、满足、期待 | stable（能量平稳）  |

> **这是整个新引擎的关键：用户不输入能量趋势，由系统自动推断。**

**Level 2：能量趋势 → 一级方向**
-----------------------

| 能量趋势    | 一级方向      |
| ------- | --------- |
| high    | cool_down |
| low     | activate  |
| chaotic | stabilize |
| stable  | maintain  |

**Level 3：情绪微调方向**
------------------

每个情绪贡献：

* 优先方向：+1

* 次优方向：+0.5

最终方向 = 分数最高的方向若冲突 → 选择最温和的方向（cool_down < stabilize < maintain < activate）
**Level 4：场景过滤**
----------------

保留：

* scene 匹配

* direction 匹配

* emotions 有交集

**Level 5：排序（Ranking）**
-----------------------

排序权重：

* 情绪匹配度（最高）

* 场景适配度

* 强度（越轻越优先）

* 新鲜度（避免重复）

**Level 6：输出**
--------------

* final_direction

* 3–5 个活动

* debug_info（可选）
