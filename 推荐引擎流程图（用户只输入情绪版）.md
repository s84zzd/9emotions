┌──────────────────────────┐
│        用户输入          │
│ emotions（1–2 个情绪）   │
└───────────────┬──────────┘
                │
                ▼
┌──────────────────────────┐
│ Step 1：情绪 → 能量趋势推断 │
│ 烦躁/压力 → high（过高）     │
│ 焦虑 → chaotic（混乱）       │
│ 无助/疲惫/忧郁 → low（过低） │
│ 平静/满足/期待 → stable（平稳）│
└───────────────┬──────────┘
                │
                ▼
┌──────────────────────────┐
│ Step 2：能量趋势 → 一级方向 │
│ high     → cool_down      │
│ low      → activate       │
│ chaotic  → stabilize      │
│ stable   → maintain       │
└───────────────┬──────────┘
                │
                ▼
┌──────────────────────────┐
│ Step 3：情绪微调方向       │
│ 根据情绪优先/次优方向加权    │
│ 选择最温和、最适合的方向     │
└───────────────┬──────────┘
                │
                ▼
┌──────────────────────────┐
│ Step 4：场景过滤活动       │
│ 仅保留：                   │
│ - scene 匹配               │
│ - direction 匹配           │
│ - emotions 有交集          │
└───────────────┬──────────┘
                │
                ▼
┌──────────────────────────┐
│ Step 5：活动排序（Ranking）│
│ - 情绪匹配度               │
│ - 场景适配度               │
│ - 强度（越轻越优先）        │
│ - 新鲜度（避免重复）        │
└───────────────┬──────────┘
                │
                ▼
┌──────────────────────────┐
│ Step 6：输出推荐           │
│ 3–5 个即时活动             │
│ + final_direction         │
│ + debug_info（可选）       │
└──────────────────────────┘
